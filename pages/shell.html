<!DOCTYPE html>
<html>
<head>
    <title>Shell Commands Interface</title>
    <style>
    #console {
        width: 500px;
        height: 200px;
        background-color: black;
        color: #4cae4c;
    }
    </style>
</head>
<body>

<h1>Shell Commands UI</h1>

<textarea id="console"></textarea>
<textarea id="input"></textarea>
<button type="submit" onclick="sendToShell()">Submit</button>


<script>
    let url = "ws://10.211.2.21:2010/stream";
    const socket = new WebSocket(url);
    socket.onopen = () => {
        console.log("connected");
        socket.send("hello server");
    };
    socket.onmessage = (e) => {
        try{
            let messageData = JSON.parse(e.data);
            appendToConsole(messageData.data);
        } catch(error) {
            console.log(e.data);
        }
    };

    function appendToConsole(str){
        let val = document.getElementById("console").value;
        val = val + str;
        document.getElementById("console").value = val;
    }

    function sendToShell(){
        let input = document.getElementById("input").value;
        console.log(input);
        let jsonBody = {
            'shellCommandString':  input
        };

        let url = "http://10.211.2.21:2010/api/v1.0/apiAndShell/sendCommandToShell/1";

        fetch(url, {
            method: 'PUT',
            headers: {
                'accept': 'application/json',
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(jsonBody)
        }).then(response => response.text().then((text) => console.log(text)));

    }
</script>
</body>
</html>

